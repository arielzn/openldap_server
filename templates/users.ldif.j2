{%- for group, users in openldap_server_users.items() -%}

dn: cn={{ group }},ou=Group,dc={{ openldap_server_domain_name.split('.')[0] }},dc={{ openldap_server_domain_name.split('.')[1] }}
objectClass: posixGroup
cn: {{ group }}
  {%- for user in users.keys() -%}
memberUid: {{ user }}
  {%- endfor -%}

  {%- for user, config in users.items() -%}
dn: uid={{ user }},ou=Group,dc={{ openldap_server_domain_name.split('.')[0] }},dc={{ openldap_server_domain_name.split('.')[1] }}
cn: {{ user }}
userPassword: {{ password }}
loginShell: 
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
  {%- endfor -%}
{%- endfor -%}
